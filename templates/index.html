<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üåê Website Pinger Dashboard</title>

  <style>
    /* ==== Base Styling ==== */
    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top left, #0a0a0f, #121212, #1f1f1f);
      color: #e0f7fa;
      text-align: center;
      padding: 50px 20px;
      min-height: 100vh;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      color: #4fc3f7;
      text-shadow: 0 0 10px #03a9f4, 0 0 20px #0288d1;
      letter-spacing: 1px;
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px #03a9f4; }
      to { text-shadow: 0 0 20px #81d4fa, 0 0 30px #03a9f4; }
    }

    .target {
      font-size: 1.1em;
      color: #90caf9;
      margin-bottom: 30px;
    }

    /* ==== Info Card ==== */
    .info {
      margin: 20px auto;
      width: 90%;
      max-width: 500px;
      padding: 25px;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.05);
      box-shadow: 0 0 25px rgba(3, 169, 244, 0.2), inset 0 0 10px rgba(3, 169, 244, 0.15);
      backdrop-filter: blur(8px);
      transition: all 0.3s ease;
    }

    .info:hover {
      transform: translateY(-3px);
      box-shadow: 0 0 40px rgba(3, 169, 244, 0.4);
    }

    .info p {
      font-size: 1.2em;
      margin: 10px 0;
      letter-spacing: 0.5px;
    }

    /* ==== Buttons ==== */
    button {
      background: linear-gradient(45deg, #03a9f4, #0288d1);
      color: white;
      border: none;
      padding: 12px 28px;
      margin: 10px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1em;
      letter-spacing: 0.5px;
      box-shadow: 0 0 15px rgba(3, 169, 244, 0.5);
      transition: 0.3s;
    }

    button:hover {
      background: linear-gradient(45deg, #0288d1, #03a9f4);
      transform: scale(1.05);
      box-shadow: 0 0 25px rgba(3, 169, 244, 0.8);
    }

    .download {
      background: linear-gradient(45deg, #43a047, #66bb6a);
      box-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
    }

    .download:hover {
      box-shadow: 0 0 25px rgba(129, 199, 132, 0.9);
      transform: scale(1.05);
    }

    /* ==== Status Lights ==== */
    .status-running {
      color: #00e676;
      font-weight: bold;
      text-shadow: 0 0 8px #00e676;
    }

    .status-stopped {
      color: #ff5252;
      font-weight: bold;
      text-shadow: 0 0 8px #ff1744;
    }

    footer {
      margin-top: 50px;
      font-size: 0.9em;
      color: #90a4ae;
      letter-spacing: 0.3px;
    }

    .dot {
      height: 12px;
      width: 12px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 6px;
    }

    .dot-running {
      background-color: #00e676;
      box-shadow: 0 0 10px #00e676;
    }

    .dot-stopped {
      background-color: #ff5252;
      box-shadow: 0 0 10px #ff5252;
    }
  </style>
</head>
<body>
  <h1>üåê Website Pinger Dashboard</h1>
  <p class="target">Target: <strong>{{ target_url }}</strong></p>

  <div class="info" id="status-box">
    <p>Status: <span class="dot dot-stopped" id="status-dot"></span><span id="status">Loading...</span></p>
    <p>Ping Count: <span id="ping_count">0</span></p>
    <p>Last Ping: <span id="last_ping">-</span></p>
    <p>Uptime: <span id="uptime">00:00:00</span></p>
  </div>

  <div>
    <button onclick="startPinger()">‚ñ∂ Start</button>
    <button onclick="stopPinger()">‚èπ Stop</button>
    <button class="download" onclick="downloadLogs()">‚¨á Download Logs</button>
  </div>

  <footer>üöÄ Developed by Shaik ‚Äî Smart Pinger v2.0</footer>

  <script>
    async function fetchStatus() {
      try {
        const res = await fetch("/status");
        const data = await res.json();

        const statusEl = document.getElementById("status");
        const dotEl = document.getElementById("status-dot");

        statusEl.textContent = data.status;
        document.getElementById("ping_count").textContent = data.ping_count;
        document.getElementById("last_ping").textContent = data.last_ping;
        document.getElementById("uptime").textContent = data.uptime;

        if (data.status === "Running") {
          statusEl.className = "status-running";
          dotEl.className = "dot dot-running";
        } else {
          statusEl.className = "status-stopped";
          dotEl.className = "dot dot-stopped";
        }
      } catch (err) {
        console.error("Error fetching status:", err);
      }
    }

    async function startPinger() {
      const res = await fetch("/start", { method: "POST" });
      const data = await res.json();
      alert(data.message || "‚úÖ Pinger started!");
      fetchStatus();
    }

    async function stopPinger() {
      const res = await fetch("/stop", { method: "POST" });
      const data = await res.json();
      alert("üõë Pinger stopped.");
      fetchStatus();
    }

    function downloadLogs() {
      window.location.href = "/download";
    }

    // Auto refresh every 5 seconds
    setInterval(fetchStatus, 5000);
    fetchStatus();
  </script>
</body>
</html>
